
@{
    ViewBag.Title = "集团工参信息导入";
}

<div class="panel panel-warning">
    <div class="panel-heading">
        <h2 class="panel-title">
            <strong>@ViewBag.Title</strong>
        </h2>
    </div>
    <div class="panel-body" ng-controller="station.import">

        <div class="row">
            <div class="form-group col-md-6">
                @using (Html.BeginForm("StationDictionaryPost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">集团站址信息文件选择：</label>
                    <div class="input-group">
                        <input name="stationDictionary" class="form-control" type="file" accept=".xlsx" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{stationInfo.totalDumpItems}}&nbsp;
                    成功数：{{stationInfo.totalSuccessItems}}&nbsp;
                    失败数：{{stationInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpStationItems()" ng-disabled="stationInfo.totalDumpItems < 7800">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initStationItems()" ng-disabled="stationInfo.totalDumpItems < 7800">
                            导入初始化
                        </button>
                    </div>
                    
                    <div uib-progress>
                        <div uib-bar value="100*stationInfo.totalSuccessItems / stationInfo.totalDumpItems" type="success">
                            <span ng-show="100*stationInfo.totalSuccessItems / stationInfo.totalDumpItems > 5">
                                {{100*stationInfo.totalSuccessItems / stationInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*stationInfo.totalFailItems / stationInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*stationInfo.totalFailItems / stationInfo.totalDumpItems > 5">
                                {{100*stationInfo.totalFailItems / stationInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
            <div class="form-group col-md-6">
                @using (Html.BeginForm("ENodebBasePost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">集团基站信息文件选择：</label>
                    <div class="input-group">
                        <input name="eNodebBase" class="form-control" type="file" accept=".xlsx" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{eNodebInfo.totalDumpItems}}&nbsp;
                    成功数：{{eNodebInfo.totalSuccessItems}}&nbsp;
                    失败数：{{eNodebInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpENodebItems()" ng-disabled="eNodebInfo.totalDumpItems < 6400">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initENodebItems()" ng-disabled="eNodebInfo.totalDumpItems < 6400">
                            导入初始化
                        </button>
                    </div>
                    
                    <div uib-progress>
                        <div uib-bar value="100*eNodebInfo.totalSuccessItems / eNodebInfo.totalDumpItems" type="success">
                            <span ng-show="100*eNodebInfo.totalSuccessItems / eNodebInfo.totalDumpItems > 5">
                                {{100*eNodebInfo.totalSuccessItems / eNodebInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*eNodebInfo.totalFailItems / eNodebInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*eNodebInfo.totalFailItems / eNodebInfo.totalDumpItems > 5">
                                {{100*eNodebInfo.totalFailItems / eNodebInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
            <div class="form-group col-md-6">
                @using (Html.BeginForm("ConstructionPost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">集团小区信息文件选择：</label>
                    <div class="input-group">
                        <input name="construction" class="form-control" type="file" accept=".xlsx" multiple="multiple" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{cellInfo.totalDumpItems}}&nbsp;
                    成功数：{{cellInfo.totalSuccessItems}}&nbsp;
                    失败数：{{cellInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpCellItems()" ng-disabled="cellInfo.totalDumpItems < 34000">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initCellItems()" ng-disabled="cellInfo.totalDumpItems < 34000">
                            导入初始化
                        </button>
                    </div>
                    
                    <div uib-progress>
                        <div uib-bar value="100*cellInfo.totalSuccessItems / cellInfo.totalDumpItems" type="success">
                            <span ng-show="100*cellInfo.totalSuccessItems / cellInfo.totalDumpItems > 5">
                                {{100*cellInfo.totalSuccessItems / cellInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*cellInfo.totalFailItems / cellInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*cellInfo.totalFailItems / cellInfo.totalDumpItems > 5">
                                {{100*cellInfo.totalFailItems / cellInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
            <div class="form-group col-md-6">
                @using (Html.BeginForm("StationRruPost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">集团RRU信息文件选择：</label>
                    <div class="input-group">
                        <input name="stationRru" class="form-control" type="file" accept=".xlsx" multiple="multiple" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{rruInfo.totalDumpItems}}&nbsp;
                    成功数：{{rruInfo.totalSuccessItems}}&nbsp;
                    失败数：{{rruInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpRruItems()" ng-disabled="rruInfo.totalDumpItems < 31000">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initRruItems()" ng-disabled="rruInfo.totalDumpItems < 31000">
                            导入初始化
                        </button>
                    </div>

                    <div uib-progress>
                        <div uib-bar value="100*rruInfo.totalSuccessItems / rruInfo.totalDumpItems" type="success">
                            <span ng-show="100*rruInfo.totalSuccessItems / rruInfo.totalDumpItems > 5">
                                {{100*rruInfo.totalSuccessItems / rruInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*rruInfo.totalFailItems / rruInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*rruInfo.totalFailItems / rruInfo.totalDumpItems > 5">
                                {{100*rruInfo.totalFailItems / rruInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
            <div class="form-group col-md-6">
                @using (Html.BeginForm("StationAntennaPost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">集团天线信息文件选择：</label>
                    <div class="input-group">
                        <input name="stationAntenna" class="form-control" type="file" accept=".xlsx" multiple="multiple" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{antennaInfo.totalDumpItems}}&nbsp;
                    成功数：{{antennaInfo.totalSuccessItems}}&nbsp;
                    失败数：{{antennaInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpAntennaItems()" ng-disabled="antennaInfo.totalDumpItems < 24000">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initAntennaItems()" ng-disabled="antennaInfo.totalDumpItems < 24000">
                            导入初始化
                        </button>
                    </div>
                    
                    <div uib-progress>
                        <div uib-bar value="100*antennaInfo.totalSuccessItems / antennaInfo.totalDumpItems" type="success">
                            <span ng-show="100*antennaInfo.totalSuccessItems / antennaInfo.totalDumpItems > 5">
                                {{100*antennaInfo.totalSuccessItems / antennaInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*antennaInfo.totalFailItems / antennaInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*antennaInfo.totalFailItems / antennaInfo.totalDumpItems > 5">
                                {{100*antennaInfo.totalFailItems / antennaInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
            <div class="form-group col-md-6">
                @using (Html.BeginForm("DistributionPost", "Parameters",
                FormMethod.Post, new { enctype = "multipart/form-data", @class = "form-horizontal", role = "form" }))
                {
                    <label class="control-label">室内分布信息文件选择：</label>
                    <div class="input-group">
                        <input name="distribution" class="form-control" type="file" accept=".xlsx" />
                        <div class="btn-group">
                            <button type="submit" class="btn btn-primary">
                                <span class="glyphicon glyphicon-save"></span>保存
                            </button>
                        </div>
                    </div>
                }
                <p>
                    总数：{{distributionInfo.totalDumpItems}}&nbsp;
                    成功数：{{distributionInfo.totalSuccessItems}}&nbsp;
                    失败数：{{distributionInfo.totalFailItems}}
                    <div class="btn-group">
                        <button class="btn btn-primary" ng-click="dumpDistributionItems()" 
                                ng-disabled="distributionInfo.totalDumpItems < 9000">
                            一键导入
                        </button>
                        <button class="btn btn-info" ng-click="initDistributionItems()"
                                ng-disabled="distributionInfo.totalDumpItems < 9000">
                            导入初始化
                        </button>
                    </div>
                    
                    <div uib-progress>
                        <div uib-bar value="100*distributionInfo.totalSuccessItems / distributionInfo.totalDumpItems" type="success">
                            <span ng-show="100*distributionInfo.totalSuccessItems / distributionInfo.totalDumpItems > 5">
                                {{100*distributionInfo.totalSuccessItems / distributionInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                        <div uib-bar value="100*distributionInfo.totalFailItems / distributionInfo.totalDumpItems" type="erroe">
                            <span ng-show="100*distributionInfo.totalFailItems / distributionInfo.totalDumpItems > 5">
                                {{100*distributionInfo.totalFailItems / distributionInfo.totalDumpItems | number: 2}}%
                            </span>
                        </div>
                    </div>
                </p>
            </div>
        </div>

    </div>
</div>

@section Scripts{
    <script src="~/Scripts/parameters/import/station.controller.js"></script>
}
