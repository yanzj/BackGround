
<div ng-controller="precise.import">
    <button class="btn btn-info"
            ng-disabled="townPreciseViews.length === 0 && townMrsStats.length === 0 && townSinrUlStats.length === 0"
            ng-click="dumpTownItems()">
        导入镇区指标
        <div class="badge">精确覆盖{{townPreciseViews.length}}</div>
        <div class="badge">RSRP覆盖{{townMrsStats.length}}</div>
        <div class="badge">上行SINR{{townSinrUlStats.length}}</div>
    </button>
    <div class="row">
        <div class="col-md-4">
            <h4>精确覆盖率小区导入</h4>
            <p>
                总数：{{progressInfo.totalDumpItems}}&nbsp;
                成功数：{{progressInfo.totalSuccessItems}}&nbsp;
                失败数：{{progressInfo.totalFailItems}}
                <div class="btn-group">
                    <button class="btn btn-primary" ng-disabled="progressInfo.totalDumpItems === 0" ng-click="dumpItems()">
                        一键导入
                    </button>
                    <button class="btn btn-danger" ng-disabled="progressInfo.totalDumpItems === 0" ng-click="clearItems()">
                        清除导入
                    </button>
                </div>
            </p>
            <div uib-progress>
                <div uib-bar value="100*progressInfo.totalSuccessItems / progressInfo.totalDumpItems" type="success">
                    <span ng-show="100*progressInfo.totalSuccessItems / progressInfo.totalDumpItems > 5">
                        {{100*progressInfo.totalSuccessItems / progressInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
                <div uib-bar value="100*progressInfo.totalFailItems / progressInfo.totalDumpItems" type="erroe">
                    <span ng-show="100*progressInfo.totalFailItems / progressInfo.totalDumpItems > 5">
                        {{100*progressInfo.totalFailItems / progressInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <h4>MRS-RSRP小区导入</h4>
            <p>
                总数：{{rsrpInfo.totalDumpItems}}&nbsp;
                成功数：{{rsrpInfo.totalSuccessItems}}&nbsp;
                失败数：{{rsrpInfo.totalFailItems}}
                <div class="btn-group">
                    <button class="btn btn-primary" ng-disabled="rsrpInfo.totalDumpItems === 0" ng-click="dumpRsrpItems()">
                        一键导入
                    </button>
                    <button class="btn btn-danger" ng-disabled="rsrpInfo.totalDumpItems === 0" ng-click="clearRsrpItems()">
                        清除导入
                    </button>
                </div>
            </p>
            <div uib-progress>
                <div uib-bar value="100*rsrpInfo.totalSuccessItems / rsrpInfo.totalDumpItems" type="success">
                    <span ng-show="100*rsrpInfo.totalSuccessItems / rsrpInfo.totalDumpItems > 5">
                        {{100*rsrpInfo.totalSuccessItems / rsrpInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
                <div uib-bar value="100*rsrpInfo.totalFailItems / rsrpInfo.totalDumpItems" type="erroe">
                    <span ng-show="100*rsrpInfo.totalFailItems / rsrpInfo.totalDumpItems > 5">
                        {{100*rsrpInfo.totalFailItems / rsrpInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <h4>MRS-SinrUL小区导入</h4>
            <p>
                总数：{{sinrUlInfo.totalDumpItems}}&nbsp;
                成功数：{{sinrUlInfo.totalSuccessItems}}&nbsp;
                失败数：{{sinrUlInfo.totalFailItems}}
                <div class="btn-group">
                    <button class="btn btn-primary" ng-disabled="sinrUlInfo.totalDumpItems === 0" ng-click="dumpSinrUlItems()">
                        一键导入
                    </button>
                    <button class="btn btn-danger" ng-disabled="sinrUlInfo.totalDumpItems === 0" ng-click="clearSinrUlItems()">
                        清除导入
                    </button>
                </div>
            </p>
            <div uib-progress>
                <div uib-bar value="100*sinrUlInfo.totalSuccessItems / sinrUlInfo.totalDumpItems" type="success">
                    <span ng-show="100*sinrUlInfo.totalSuccessItems / sinrUlInfo.totalDumpItems > 5">
                        {{100*sinrUlInfo.totalSuccessItems / sinrUlInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
                <div uib-bar value="100*sinrUlInfo.totalFailItems / sinrUlInfo.totalDumpItems" type="erroe">
                    <span ng-show="100*sinrUlInfo.totalFailItems / sinrUlInfo.totalDumpItems > 5">
                        {{100*sinrUlInfo.totalFailItems / sinrUlInfo.totalDumpItems | number: 2}}%
                    </span>
                </div>
            </div>
        </div>
    </div>

    <div date-span-row begin-date="beginDate" end-date="endDate">
        <div class="btn-group">
            <button class="btn btn-primary" ng-click="updateHistory()">更新</button>
        </div>
    </div>
    <table class="table table-hover">
        <thead>
        <tr>
            <th>-</th>
            <th colspan="7">
                精确覆盖
            </th>
            <th colspan="3">
                MRS覆盖
            </th>
            <th colspan="3">
                SinrUL覆盖
            </th>
        </tr>
        <tr>
            <th>日期</th>
            <th>小区数量</th>
            <th>镇</th>
            <th>校园</th>
            <th>镇-800</th>
            <th>镇-1800</th>
            <th>镇-2100</th>
            <th style="width: 150px">操作</th>
            <th>TOP</th>
            <th>镇</th>
            <th style="width: 140px">操作</th>
            <th>TOP</th>
            <th>镇</th>
            <th style="width: 140px">操作</th>
        </tr>
        </thead>
        <tbody>
            <tr ng-repeat="stat in dumpHistory">
                <td>{{stat.dateString}}</td>
                <td>{{stat.preciseStats}}</td>
                <td>{{stat.townPreciseStats}}</td>
                <td>{{stat.collegePreciseStats}}</td>
                <td>{{stat.townPrecise800Stats}}</td>
                <td>{{stat.townPrecise1800Stats}}</td>
                <td>{{stat.townPrecise2100Stats}}</td>
                <td>
                    <div class="btn-group-sm">
                        <button type="button" class="btn btn-sm btn-success" ng-click="updateMongoItems(stat.statDate)">
                            Mongo
                        </button>
                        <button class="btn btn-sm btn-default" ng-click="updateTownItems(stat.statDate)">
                            镇区
                        </button>
                    </div>
                </td>
                <td>{{stat.topMrsStats}}</td>
                <td>{{stat.townMrsStats}}</td>
                <td>
                    <div class="btn-group-sm">
                        <button class="btn btn-sm btn-success" ng-click="updateTopMrsItems(stat.statDate)">
                            TOP
                        </button>
                        <button class="btn btn-sm btn-default" ng-click="updateTownMrsItems(stat.statDate)">
                            镇区
                        </button>
                    </div>
                </td>
                <td>{{stat.topSinrUlStats}}</td>
                <td>{{stat.townSinrUlStats}}</td>
                <td>
                    <div class="btn-group-sm">
                        <button class="btn btn-sm btn-success" ng-click="updateTopSinrUlItems(stat.statDate)">
                            TOP
                        </button>
                        <button class="btn btn-sm btn-default" ng-click="updateTownSinrUlItems(stat.statDate)">
                            镇区
                        </button>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

@section Scripts{
    <script src="~/Scripts/kpi/precise.import.js"></script>
}